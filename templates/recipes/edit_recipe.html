<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
  <title>Edit Recipe</title>
  <link rel="stylesheet" href="/static/css/styles.css">
  <style>
    .ingredient-row input, .ingredient-row select {
      width: 90%;
    }
    .ingredient-row td {
      padding: 0.3rem;
    }
    .action-btn {
      margin-right: 1rem;
    }
    .step-row textarea {
      width: 100%;
      min-height: 50px;
    }
  </style>
<body class="recipes-page">
  <a href="/recipes/" class="back-link">← All Recipes</a>
  <h1>Edit Recipe</h1>

  <div id="recipe-form">
    <div class="form-field">
      <label>Recipe Name:</label>
      <input type="text" id="recipe-name-input" />
    </div>

    <div class="form-field">
      <label>Portion Size:</label>
      <input type="text" id="portion-size-input" />
    </div>

    <div style="display: flex; align-items: center; margin-bottom: 1rem;">
      <label for="description-input" style="margin-right: 0.5rem;">Description:</label>
      <textarea id="description-input" rows="4" style="width: 250px;"></textarea>
    </div>

    <!-- Total cost display -->
    <div id="recipe-total-cost" style="text-align: right; font-weight: bold; margin-top: 0.5rem;">
      Total Cost: £0.00
    </div>

    <h2>Ingredients</h2>
    <table id="ingredients-table">
      <thead>
        <tr>
          <th>Ingredient</th>
          <th>Quantity</th>
          <th>Unit</th>
          <th>Cost</th>
          <th>Base Quantity</th>
          <th>Base Unit</th>
          <th>Base Price</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="ingredients-tbody"></tbody>
    </table>
    <button id="add-ingredient-btn" class="action-btn">Add Ingredient</button>

    <h2>Steps</h2>
    <div id="steps-container"></div>
    <button id="add-step-btn" class="action-btn">Add Step</button>

    <div id="error" class="error"></div>
    <div style="margin-top:1rem;">
      <button id="save-recipe-btn" class="action-btn">Save Recipe</button>
      <button id="cancel-edit-btn" class="action-btn">Cancel</button>
    </div>
  </div>

  <!-- Hidden templates for JS cloning -->
  <table style="display:none;">
    <tbody>
      <tr id="ingredient-template" class="ingredient-row">
        <td><input type="text" class="ingredient-name" /></td>
        <td><input type="number" class="quantity" min="0" step="any" /></td>
        <td>
          <select class="unit-select">
            <!-- dynamically populated -->
          </select>
        </td>
        <td><input type="number" class="cost" readonly /></td>
        <td><input type="number" class="base-quantity" min="0" step="any" /></td>
        <td>
          <select class="base-unit-select">
            <!-- dynamically populated based on old unit group -->
          </select>
        </td>
        <td><input type="number" class="base-price" step="any" /></td>
        <td><button class="remove-ingredient-btn">Remove</button></td>
      </tr>
    </tbody>
  </table>

  <template id="step-template">
    <div class="step-row">
      <textarea class="step-text"></textarea>
      <button class="remove-step-btn">Remove</button>
    </div>
  </template>

  <div id="modal-overlay" class="modal-overlay" style="display:none;">
    <div id="alert-box" class="alert-box">
      <p id="alert-message"></p>
      <div id="alert-actions"></div>
    </div>
  </div>
  

    <script>
    window.recipeId = window.location.pathname.split("/").pop(); // window coz to send recipeId in js    
    </script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/edit-recipe.js" defer></script>
</body>