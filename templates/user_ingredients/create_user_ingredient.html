
{% extends "base.html" %}

{% block title %}Add New Ingredient{% endblock %}

{% block head %}
    <style>
        .ingredient-image {
            max-width: 100%;
            border-radius: 16px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .form-card {
            background: #ffffff;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
        }
        .form-control::placeholder {
            color: var(--bs-secondary-color) !important;
            opacity: 0.5 !important;
        }
    </style>
{% endblock %}

{% block content %}
<div class="container py-5">

    <!-- Heading -->
    <div class="row mb-4">
        <div class="col text-center">
            <h2 class="fw-bold">Add New Ingredient</h2>
            <p class="text-muted">
                Add your custom ingredient with pricing and unit details
            </p>
        </div>
    </div>

    <!-- Content -->
    <div class="row align-items-start g-4">

        <!-- Left: Form -->
        <div class="col-lg-7">
            <div class="form-card">

                <form method="POST" id="ingredientForm">

                    <!-- Name -->
                    <div class="mb-3">
                        <label class="form-label">Ingredient Name</label>
                        <input
                            id="ingredient_name"
                            name="ingredient_name"
                            type="text"
                            class="form-control"
                            placeholder="e.g. Basmati Rice"
                            required
                        >
                        <div id="nameError" class="text-danger"></div>
                    </div>

                    <!-- Price + Quantity + Weighing Unit -->
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Price</label>
                            <input
                                id="price"
                                name="price"
                                type="number"
                                class="form-control no-invalid-number"
                                placeholder="e.g. 4.50"
                                step="0.01"
                                required
                            >
                        </div>

                        <div class="col-md-4 mb-3">
                            <label class="form-label">Quantity</label>
                            <input
                                id="quantity"
                                name="quantity"
                                type="number"
                                class="form-control no-invalid-number"
                                placeholder="e.g. 1"
                                step="0.001"
                                required
                            >
                        </div>
                    
                        <div class="col-md-4 mb-3">
                            <label class="form-label">Weighing Unit</label>
                            <select class="form-select" id="unit" name="unit" required>
                                <option value="">Select unit</option>
                                <option value="kg">Kilogram (kg)</option>
                                <option value="g">Gram (g)</option>
                                <option value="l">Litre (l)</option>
                                <option value="ml">Millilitre (ml)</option>
                                <option value="pc">Piece (pc)</option>
                                <option value="bunch">Bunch</option>
                            </select>
                        </div>
                    </div>

                    <div class="border-top my-4"></div>

                    <!-- CupWeighing info -->
                    <div class="mb-3">
                        <div class="form-text mb-3">
                            Cup weight is optional, but providing it allows the app to generate additional ingredient units (such as cup, tablespoon, and teaspoon) when creating recipes.
                            This is most useful for ingredients like grains, flour, powders, etc., that are commonly measured in cup, tablespoon, teaspoon, etc.
                        </div>

                        <div class="form-text mb-3 fst-italic">
                            * If an ingredient isnâ€™t typically measured in cups, tablespoons or teaspoons, you can safely leave this blank.
                        </div>
                    </div>

                    <!-- Cup Weight + Cup Unit -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label">
                                Weight of Cup
                                <span class="text-muted">(optional)</span>
                            </label>
                            <input
                                id="cup_weight"
                                name="cup_weight"
                                type="number"
                                class="form-control no-invalid-number"
                                placeholder="e.g. 120"
                                step="0.001"
                            >
                        </div>

                        <div class="col-md-6 mb-3">
                            <label class="form-label">Cup Weighing Unit</label>
                            <select class="form-select" id="cup_unit" name="cup_unit">
                                <option value="">Select unit</option>
                                <option value="g">Gram (g)</option>
                                <option value="kg">Kilogram (kg)</option>
                                <option value="oz">Ounce (oz)</option>
                                <option value="lbs">Pound (lbs)</option>
                            </select>
                        </div>
                    </div>

                    <div id="cupError" class="bi bi-info-circle text-danger d-none">
                    </div>                    

                    <!-- Actions -->
                    <div class="d-flex justify-content-between align-items-center mt-4">
                        <!-- Left side buttons -->
                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-success">
                                Save Ingredient
                            </button>
                            <a href="#" id="cancelBtn" class="btn btn-outline-secondary">
                                Cancel
                            </a>
                        </div>
                    </div>

                    <div id="error" class="text-danger-emphasis">
                    </div>

                </form>

            </div>
        </div>

        <!-- Right: Image -->
        <div class="col-lg-5 text-center">
            <label  for="imageInput" style="cursor:pointer;">
                    <img
                    id="imagePreview"
                    src="https://images.unsplash.com/photo-1601004890684-d8cbf643f5f2"
                    alt="Ingredient"
                    class="ingredient-image"
                >    
            </label>

            <input 
                type="file" 
                id="imageInput" 
                name="image"
                accept="image/*"
                hidden
            >

            <p class="text-muted mt-2">Click image to upload</p>
        </div>

    </div>
</div>
{% endblock %}

{% block scripts %}
<script type="module" src="/static/js/features/user_ingredients/create-user-ingredient.js"></script>
{% endblock %}
